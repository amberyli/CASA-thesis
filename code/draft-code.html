<pre><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;; Variables ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">globals</font><font color="#000000"><br />[<br />  </font><font color="#5a5a5a">;1. Network and population</font><font color="#000000"><br />  </font><font color="#5a5a5a">; no-of-nodes                             ;the number of places in the world</font><font color="#000000"><br />  </font><font color="#5a5a5a">; average-node-degree                     ;the average number of links for each</font><font color="#000000"><br />  </font><font color="#5a5a5a">; rural-pop                               ;the number of population in each city area</font><font color="#000000"><br />  </font><font color="#5a5a5a">; urban-pop                               ;the number of population in each countryside</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;2. SIR</font><font color="#000000"><br />  </font><font color="#5a5a5a">; initial-outbreak-area                   ;select areas to have the initial outbreak</font><font color="#000000"><br />  </font><font color="#5a5a5a">; initial-outbreak-size                   ;the number of places that initial infection happen</font><font color="#000000"><br />  </font><font color="#5a5a5a">; prob-infected                           ;the probability that people might get infected</font><font color="#000000"><br />  </font><font color="#5a5a5a">; prob-recovered                          ;the probability that people could recover after infection</font><font color="#000000"><br />  </font><font color="#5a5a5a">; prob-resistant                          ;the probability that people could gain resistance after recovery</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;3. Tourist</font><font color="#000000"><br />  </font><font color="#5a5a5a">; tourist-rate                            ;the percetange of people would migrate between areas</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;4. For Monitoring and research purpose</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;4.1 for WHOLE population</font><font color="#000000"><br />  </font><font color="#5a5a5a">;4.1.1 store the value in lists</font><font color="#000000"><br />  total-pop                                      </font><font color="#5a5a5a">;the LIST of WHOLE population</font><font color="#000000"><br />  total-pop-urban                                </font><font color="#5a5a5a">;the LIST of WHOLE population in cities</font><font color="#000000"><br />  total-pop-rural                                </font><font color="#5a5a5a">;the LIST of WHOLE population in countryside</font><font color="#000000"><br />  total-pop-s                                    </font><font color="#5a5a5a">;the LIST of Susceptible population</font><font color="#000000"><br />  total-pop-s-urban                              </font><font color="#5a5a5a">;the LIST of Susceptible population in cities</font><font color="#000000"><br />  total-pop-s-rural                              </font><font color="#5a5a5a">;the LIST of Susceptible population in countryside</font><font color="#000000"><br />  total-pop-i                                    </font><font color="#5a5a5a">;the LIST of Infected population</font><font color="#000000"><br />  total-pop-i-urban                              </font><font color="#5a5a5a">;the LIST of Infected population in cities</font><font color="#000000"><br />  total-pop-i-rural                              </font><font color="#5a5a5a">;the LIST of Infected population in countryside</font><font color="#000000"><br />  total-pop-r                                    </font><font color="#5a5a5a">;the LIST of Resistant population</font><font color="#000000"><br />  total-pop-r-urban                              </font><font color="#5a5a5a">;the LIST of Resistant population in cities</font><font color="#000000"><br />  total-pop-r-rural                              </font><font color="#5a5a5a">;the LIST of Resistant population in countryside</font><font color="#000000"><br />  </font><font color="#5a5a5a">;4.1.2 calculate the sum value</font><font color="#000000"><br />  sum-total-pop                                  </font><font color="#5a5a5a">;the SUM of WHOLEpopulation</font><font color="#000000"><br />  sum-total-pop-urban                            </font><font color="#5a5a5a">;the SUM of WHOLE population in cities</font><font color="#000000"><br />  sum-total-pop-rural                            </font><font color="#5a5a5a">;the SUM of WHOLE population in countryside</font><font color="#000000"><br />  %-sum-total-pop-s                              </font><font color="#5a5a5a">;the RATIO of All Susceptible population over Whole population</font><font color="#000000"><br />  %-sum-total-pop-s-urban                        </font><font color="#5a5a5a">;the RATIO of All Susceptible population over Whole population in cities</font><font color="#000000"><br />  %-sum-total-pop-s-rural                        </font><font color="#5a5a5a">;the RATIO of All Susceptible population over Whole population in countryside</font><font color="#000000"><br />  %-sum-total-pop-i                              </font><font color="#5a5a5a">;the RATIO of All Infected population over Whole population</font><font color="#000000"><br />  %-sum-total-pop-i-urban                        </font><font color="#5a5a5a">;the RATIO of All Infected population over Whole population in cities</font><font color="#000000"><br />  %-sum-total-pop-i-rural                        </font><font color="#5a5a5a">;the RATIO of All Infected population over Whole population in countryside</font><font color="#000000"><br />  %-sum-total-pop-r                              </font><font color="#5a5a5a">;the RATIO of All Resistant population over Whole population</font><font color="#000000"><br />  %-sum-total-pop-r-urban                        </font><font color="#5a5a5a">;the RATIO of All Resistant population over Whole population in cities</font><font color="#000000"><br />  %-sum-total-pop-r-rural                        </font><font color="#5a5a5a">;the RATIO of All Resistant population over Whole population in countryside</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;4.2 for EACH nodes</font><font color="#000000"><br />  </font><font color="#5a5a5a">;4.2.1 store the value in lists</font><font color="#000000"><br />  total-pop-s-%                               </font><font color="#5a5a5a">;The LIST of the percentage of Susceptible people</font><font color="#000000"><br />  total-pop-s-%-urban                         </font><font color="#5a5a5a">;The LIST of the percentage of Susceptible people in cities</font><font color="#000000"><br />  total-pop-s-%-rural                         </font><font color="#5a5a5a">;The LIST of the percentage of Susceptible people in countryside</font><font color="#000000"><br />  total-pop-i-%                               </font><font color="#5a5a5a">;The LIST of the percentage of Infected people</font><font color="#000000"><br />  total-pop-i-%-urban                         </font><font color="#5a5a5a">;The LIST of the percentage of Infected people in cities</font><font color="#000000"><br />  total-pop-i-%-rural                         </font><font color="#5a5a5a">;The LIST of the percentage of Infected people in countryside</font><font color="#000000"><br />  total-pop-r-%                               </font><font color="#5a5a5a">;The LIST of the percentage of Resistant people</font><font color="#000000"><br />  total-pop-r-%-urban                         </font><font color="#5a5a5a">;The LIST of the percentage of Resistant people in cities</font><font color="#000000"><br />  total-pop-r-%-rural                         </font><font color="#5a5a5a">;The LIST of the percentage of Resistant people in countryside</font><font color="#000000"><br />  </font><font color="#5a5a5a">;4.2.2 calculate the mean</font><font color="#000000"><br />  mean-total-pop-s-%                          </font><font color="#5a5a5a">;The MEAN of the percentage of Susceptible people</font><font color="#000000"><br />  mean-total-pop-s-%-urban                    </font><font color="#5a5a5a">;The MEAN of the percentage of Susceptible people in cities</font><font color="#000000"><br />  mean-total-pop-s-%-rural                    </font><font color="#5a5a5a">;The MEAN of the percentage of Susceptible people in countryside</font><font color="#000000"><br />  mean-total-pop-i-%                          </font><font color="#5a5a5a">;The MEAN of the percentage of Infected people</font><font color="#000000"><br />  mean-total-pop-i-%-urban                    </font><font color="#5a5a5a">;The MEAN of the percentage of Infected people in cities</font><font color="#000000"><br />  mean-total-pop-i-%-rural                    </font><font color="#5a5a5a">;The MEAN of the percentage of Infected people in countryside</font><font color="#000000"><br />  mean-total-pop-r-%                          </font><font color="#5a5a5a">;The MEAN of the percentage of Resistant people</font><font color="#000000"><br />  mean-total-pop-r-%-urban                    </font><font color="#5a5a5a">;The MEAN of the percentage of Resistant people in cities</font><font color="#000000"><br />  mean-total-pop-r-%-rural                    </font><font color="#5a5a5a">;The MEAN of the percentage of Resistant people in countryside</font><font color="#000000"><br />  </font><font color="#5a5a5a">;4.2.3 calculate the mean</font><font color="#000000"><br />  var-total-pop-r-%                           </font><font color="#5a5a5a">;The VARIANCE of the percentage of Resistant people</font><font color="#000000"><br />  var-total-pop-r-%-urban                     </font><font color="#5a5a5a">;The VARIANCE of the percentage of Resistant people in cities</font><font color="#000000"><br />  var-total-pop-r-%-rural                     </font><font color="#5a5a5a">;The VARIANCE of the percentage of Resistant people in countryside</font><font color="#000000"><br />]<br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /></font><font color="#007f69">turtles-own</font><font color="#000000"><br />[<br />  </font><font color="#5a5a5a">;0.</font><font color="#000000"><br />  pop-at-start                              </font><font color="#5a5a5a">;the number of population at this node at the start of each tick</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;1. Population and SIR</font><font color="#000000"><br />  current-pop                               </font><font color="#5a5a5a">;the number of population at this node at the end of each tick</font><font color="#000000"><br />  pop-s                                     </font><font color="#5a5a5a">;the number of susceptible people at here</font><font color="#000000"><br />  pop-i                                     </font><font color="#5a5a5a">;the number of infected people at here</font><font color="#000000"><br />  pop-r                                     </font><font color="#5a5a5a">;the number of resistant people at here</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;2. Migration</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;2.1 Linked Neighbors</font><font color="#000000"><br />  neighbor-index-list                       </font><font color="#5a5a5a">;for each, the list of its linked neighbor's index</font><font color="#000000"><br />  neighbor-pop-list                         </font><font color="#5a5a5a">;for each, the list of its linked neighbor's population</font><font color="#000000"><br />  neighbor-pop-normalised-list              </font><font color="#5a5a5a">;for each, the normalised list of its linked neighbor's population</font><font color="#000000"><br />  p                                         </font><font color="#5a5a5a">;random value between 0 and 1</font><font color="#000000"><br />  turtle-who                                </font><font color="#5a5a5a">;for each, the index of the destination turlte</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;2.2 Tourist</font><font color="#000000"><br />  here-pop-list                             </font><font color="#5a5a5a">;for each, the list of its SIR population</font><font color="#000000"><br />  here-pop-normalised-list                  </font><font color="#5a5a5a">;for each, the normalied list of its SIR population</font><font color="#000000"><br />  pop-tourists                              </font><font color="#5a5a5a">;for each, the number of tourist population</font><font color="#000000"><br />  </font><font color="#5a5a5a">;q                                        ;random value between 0 and 1 (repeat several times)</font><font color="#000000"><br />  tourist-status-list                       </font><font color="#5a5a5a">;for each, the list containing the status of every tourist</font><font color="#000000"><br />  t-pop-s                                   </font><font color="#5a5a5a">;for each, the number of TOURISTS that are susceptible</font><font color="#000000"><br />  t-pop-i                                   </font><font color="#5a5a5a">;for each, the number of TOURISTS that are infected</font><font color="#000000"><br />  t-pop-r                                   </font><font color="#5a5a5a">;for each, the number of TOURISTS that are resistant</font><font color="#000000"><br />]<br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; SETUP ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;1. Network</font><font color="#000000"><br />  setup-nodes<br />  setup-spatially-clustered-network<br /><br />  </font><font color="#5a5a5a">;2. Define 2 types of area and assign population</font><font color="#000000"><br />  setup-urban-rural<br /><br />  </font><font color="#5a5a5a">;3. Set initial outbreak</font><font color="#000000"><br />  </font><font color="#5a5a5a">; Note, they won't start to be infected at tick = 0, the infection would be set at &quot;go&quot;</font><font color="#000000"><br />  setup-initial-outbreak<br /><br />  </font><font color="#5a5a5a">;4. Record the linked neighbors population and corresponding index at the beginning</font><font color="#000000"><br />  setup-neighbor-list<br /><br />  </font><font color="#5a5a5a">;5. Monitoring I</font><font color="#000000"><br />  monitor-pop-all-turtles<br />  monitor-pop-urban-turtles<br />  monitor-pop-rural-turtles<br /><br />  </font><font color="#5a5a5a">;6. Monitoring II</font><font color="#000000"><br />  monitor-pop-%-all-turtles<br />  monitor-pop-%-urban-turtles<br />  monitor-pop-%-rural-turtles<br /><br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;1.1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup-nodes<br />  </font><font color="#5a5a5a">;set-default-shape turtles &quot;circle&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">create-turtles</font><font color="#000000"> no-of-nodes<br />  [<br />    </font><font color="#5a5a5a">; Scenario1. for visual reasons, we don't put any nodes *too* close to the edges</font><font color="#000000"><br />    </font><font color="#0000aa">setxy</font><font color="#000000"> (</font><font color="#660096">random-xcor</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.95</font><font color="#000000">) (</font><font color="#660096">random-ycor</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.95</font><font color="#000000">)<br />    </font><font color="#5a5a5a">; Scenario2. Don't care about that. In reality, it is possible to have *close* cases.</font><font color="#000000"><br />    </font><font color="#5a5a5a">;setxy random-xcor random-ycor</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;1.2;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup-spatially-clustered-network<br />  </font><font color="#0000aa">let</font><font color="#000000"> num-links (average-node-degree </font><font color="#660096">*</font><font color="#000000"> no-of-nodes) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />  </font><font color="#0000aa">while</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> num-links ]<br />  [<br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />    [<br />      </font><font color="#0000aa">let</font><font color="#000000"> choice (</font><font color="#660096">min-one-of</font><font color="#000000"> (</font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">link-neighbor?</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">])<br />                   [</font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">])<br />      </font><font color="#0000aa">if</font><font color="#000000"> choice </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [ </font><font color="#0000aa">create-link-with</font><font color="#000000"> choice ]<br />      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> ]<br />    ]<br />  ]<br /><br />  </font><font color="#5a5a5a">; make the network look a little prettier</font><font color="#000000"><br />  </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"><br />  [<br />    </font><font color="#0000aa">layout-spring</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#963700">0.3</font><font color="#000000"> (</font><font color="#660096">world-width</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">sqrt</font><font color="#000000"> no-of-nodes)) </font><font color="#963700">1</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;2;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup-urban-rural<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br /><br />    </font><font color="#5a5a5a">;at beginning, set all to be colored by blue</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"><br /><br />    </font><font color="#5a5a5a">;no infection and no resistance at this step</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-i </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-r </font><font color="#963700">0</font><font color="#000000"><br /><br />    </font><font color="#5a5a5a">;compare links to distinguish urban and rural areas</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> average-node-degree<br />    [<br />      </font><font color="#5a5a5a">; Scenario 1. less linked --&gt; countryside</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;triangle&quot;</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> pop-S rural-pop<br />    ]<br />    [<br />      </font><font color="#5a5a5a">; Scenario 2. more linked --&gt; city</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;house&quot;</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> pop-S urban-pop<br />    ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> current-pop (pop-s </font><font color="#660096">+</font><font color="#000000"> pop-i </font><font color="#660096">+</font><font color="#000000"> pop-r)<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;3.;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup-initial-outbreak<br />  </font><font color="#5a5a5a">; Scenario 1. initially happened in cities, then randomly pick turtles in cities to be red</font><font color="#000000"><br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> initial-outbreak-area </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;urban-area&quot;</font><font color="#000000"><br />  [<br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">n-of</font><font color="#000000"> initial-outbreak-size </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">shape</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;house&quot;</font><font color="#000000">]<br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]<br />  ]<br />  </font><font color="#5a5a5a">; Scenario 2. norice only 3 selection, neither happen randomly nor in cities, means happen in countryside</font><font color="#000000"><br />  [<br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">n-of</font><font color="#000000"> initial-outbreak-size </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">shape</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;triangle&quot;</font><font color="#000000">]<br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;4.;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup-neighbor-list<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#5a5a5a">;get their index</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> neighbor-index-list ([</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">)<br />    </font><font color="#5a5a5a">;get their population</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> neighbor-pop-list ([current-pop] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">)<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;5.;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;See 5.1 ~ 5.3 in &quot;go&quot;</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;6.;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;See 6.1 ~ 6.3 in &quot;go&quot;</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;; to go function ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />  </font><font color="#5a5a5a">;0. Record the overall population at the start of each tick</font><font color="#000000"><br />  population-at-beginning<br /><br />  </font><font color="#5a5a5a">;1. Internal SIR calculation</font><font color="#000000"><br />  </font><font color="#5a5a5a">;Must done first!</font><font color="#000000"><br />  update-turtles-population-SIR<br /><br />  </font><font color="#5a5a5a">;2. External Migration preparation</font><font color="#000000"><br />  prepare-normalisation-for-destination<br />  prepare-decide-destination<br />  prepare-normalisation-for-status<br />  prepare-decide-status<br /><br />  </font><font color="#5a5a5a">;3. External Migration update</font><font color="#000000"><br />  update-turtles-population-Migration<br /><br />  </font><font color="#5a5a5a">;4. Update colors</font><font color="#000000"><br />  update-links-color<br />  update-turtles-color<br /><br />  </font><font color="#5a5a5a">;5. Monitoring I</font><font color="#000000"><br />  monitor-pop-all-turtles<br />  monitor-pop-urban-turtles<br />  monitor-pop-rural-turtles<br /><br />  </font><font color="#5a5a5a">;6. Monitoring II</font><font color="#000000"><br />  monitor-pop-%-all-turtles<br />  monitor-pop-%-urban-turtles<br />  monitor-pop-%-rural-turtles<br /><br />  </font><font color="#5a5a5a">;6. Stop at the fixed time to compare the results</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> [</font><font color="#0000aa">stop</font><font color="#000000">]<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;0.;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> population-at-beginning<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#5a5a5a">; Store the overall population at the beginning of each tick.</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-at-start current-pop<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;1.;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-turtles-population-SIR<br />  </font><font color="#5a5a5a">; this part, only apply the SIR calculation for those who have infections</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]<br />  [<br />    </font><font color="#5a5a5a">; For group S, there are 4 final results</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> new-pop-s1  (pop-s </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> prob-infected))<br />    </font><font color="#0000aa">let</font><font color="#000000"> new-pop-s2  (pop-s </font><font color="#660096">*</font><font color="#000000"> prob-infected </font><font color="#660096">*</font><font color="#000000"> prob-recovered </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> prob-resistant))<br />    </font><font color="#0000aa">let</font><font color="#000000"> new-pop-i1  (pop-s </font><font color="#660096">*</font><font color="#000000"> prob-infected </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> prob-recovered))<br />    </font><font color="#0000aa">let</font><font color="#000000"> new-pop-r1  (pop-s </font><font color="#660096">*</font><font color="#000000"> prob-infected </font><font color="#660096">*</font><font color="#000000"> prob-recovered </font><font color="#660096">*</font><font color="#000000"> prob-resistant)<br /><br />    </font><font color="#5a5a5a">; For group I, there are 3 final results</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> new-pop-s3  (pop-i </font><font color="#660096">*</font><font color="#000000"> prob-recovered </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> prob-resistant))<br />    </font><font color="#0000aa">let</font><font color="#000000"> new-pop-i2  (pop-i </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> prob-recovered))<br />    </font><font color="#0000aa">let</font><font color="#000000"> new-pop-r2  (pop-i </font><font color="#660096">*</font><font color="#000000"> prob-recovered </font><font color="#660096">*</font><font color="#000000"> prob-resistant)<br /><br />    </font><font color="#5a5a5a">; For group R, only 1 result</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> new-pop-R3   pop-r<br /><br />    </font><font color="#5a5a5a">; Update the 3 groups and the total population for every node</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-i </font><font color="#660096">floor</font><font color="#000000"> (new-pop-i1 </font><font color="#660096">+</font><font color="#000000"> new-pop-i2)<br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-r </font><font color="#660096">floor</font><font color="#000000"> (new-pop-r1 </font><font color="#660096">+</font><font color="#000000"> new-pop-r2 </font><font color="#660096">+</font><font color="#000000"> new-pop-r3)<br />    </font><font color="#5a5a5a">; Because no death rate and SIR is in fron of Migration,</font><font color="#000000"><br />    </font><font color="#5a5a5a">; the total number of people would not change</font><font color="#000000"><br />    </font><font color="#5a5a5a">; say: at this stage: current-pop = pop-at-start</font><font color="#000000"><br />    </font><font color="#5a5a5a">; So no matter to use which in the below line</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-s (current-pop </font><font color="#660096">-</font><font color="#000000"> pop-i </font><font color="#660096">-</font><font color="#000000"> pop-r)<br />    </font><font color="#5a5a5a">; Notice floor is used for pop-i and pop-r</font><font color="#000000"><br />    </font><font color="#5a5a5a">; The exact value of pop-s is the line below</font><font color="#000000"><br />    </font><font color="#5a5a5a">;set pop-s (new-pop-s1 + new-pop-s2 + new-pop-s3)</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;2.1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> prepare-normalisation-for-destination<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  [<br />    </font><font color="#5a5a5a">; create a new variable to store the population of all linked neighbors as a list</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> new-lst neighbor-pop-list<br />    </font><font color="#5a5a5a">; calculate the sum of the new list</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> lst-sum </font><font color="#660096">sum</font><font color="#000000"> neighbor-pop-list<br />    </font><font color="#5a5a5a">; let every element in the list divided by its sum</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> divided-var </font><font color="#660096">map</font><font color="#000000"> [ i -&gt; i </font><font color="#660096">/</font><font color="#000000"> lst-sum] new-lst<br />    </font><font color="#5a5a5a">; cumulatively add each element one by one (means the first keeps the same and the last to be 1)</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> neighbor-pop-normalised-list </font><font color="#660096">butfirst</font><font color="#000000"> </font><font color="#660096">reduce</font><font color="#000000"> [[result-so-far next-item] -&gt; </font><font color="#660096">lput</font><font color="#000000"> (next-item </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">last</font><font color="#000000"> result-so-far) result-so-far] </font><font color="#660096">fput</font><font color="#000000"> [</font><font color="#963700">0</font><font color="#000000">] divided-var<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;2.2;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> prepare-decide-destination<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  [<br />    </font><font color="#5a5a5a">; Set a random value between 0 and 1</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> p </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    </font><font color="#5a5a5a">; Compare p with each element in the neighbor-cum-list and get its index</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> p-index </font><font color="#660096">position</font><font color="#000000"> p (</font><font color="#660096">sort</font><font color="#000000"> </font><font color="#660096">lput</font><font color="#000000"> p neighbor-pop-normalised-list)<br />    </font><font color="#5a5a5a">; Find the [who] of the destination turtle that has the same index</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> turtle-who </font><font color="#660096">item</font><font color="#000000"> p-index neighbor-index-list<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;2.3;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> prepare-normalisation-for-status<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  [<br />    </font><font color="#5a5a5a">; Calcualte the proportion of SIR population among the whole population at each node</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> rate-pop-s (pop-s </font><font color="#660096">/</font><font color="#000000"> current-pop)<br />    </font><font color="#0000aa">let</font><font color="#000000"> rate-pop-i (pop-i </font><font color="#660096">/</font><font color="#000000"> current-pop)<br />    </font><font color="#0000aa">let</font><font color="#000000"> rate-pop-r (pop-r </font><font color="#660096">/</font><font color="#000000"> current-pop)<br /><br />    </font><font color="#5a5a5a">; Define a new list to store the 3 rates</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> here-pop-list </font><font color="#660096">list</font><font color="#000000"> (rate-pop-s) (rate-pop-i)<br />    </font><font color="#0000aa">set</font><font color="#000000"> here-pop-list </font><font color="#660096">lput</font><font color="#000000"> rate-pop-r here-pop-list<br /><br />    </font><font color="#5a5a5a">; Normalise the here-pop-list and store in a new list</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> here-pop-normalised-list </font><font color="#660096">butfirst</font><font color="#000000"> </font><font color="#660096">reduce</font><font color="#000000"> [[result-so-far1 next-item1] -&gt; </font><font color="#660096">lput</font><font color="#000000"> (next-item1 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">last</font><font color="#000000"> result-so-far1) result-so-far1] </font><font color="#660096">fput</font><font color="#000000"> [</font><font color="#963700">0</font><font color="#000000">] here-pop-list<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;2.4;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> prepare-decide-status<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  [<br />    </font><font color="#5a5a5a">; Calculate the number of tourists</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-tourists (tourist-rate </font><font color="#660096">*</font><font color="#000000"> current-pop)<br /><br />    </font><font color="#5a5a5a">; When it is bigger than 1, it's okay to use floor</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> pop-tourists </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> pop-tourists (</font><font color="#660096">floor</font><font color="#000000"> pop-tourists) ]<br />    [<br />      </font><font color="#5a5a5a">; When it is less than 1, and current population is bigger than 1</font><font color="#000000"><br />      </font><font color="#5a5a5a">; Set it to be 1</font><font color="#000000"><br />      </font><font color="#0000aa">ifelse</font><font color="#000000"> current-pop </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      [</font><font color="#0000aa">set</font><font color="#000000"> pop-tourists </font><font color="#963700">1</font><font color="#000000">]<br />      </font><font color="#5a5a5a">; Otherwise, it is 0</font><font color="#000000"><br />      [</font><font color="#0000aa">set</font><font color="#000000"> pop-tourists </font><font color="#963700">0</font><font color="#000000">]<br />    ]<br /><br />    </font><font color="#5a5a5a">; If no tourist, no decision to make</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> pop-tourists </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">[<br />      </font><font color="#0000aa">set</font><font color="#000000"> t-pop-s </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> t-pop-i </font><font color="#963700">0</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> t-pop-r </font><font color="#963700">0</font><font color="#000000">]<br />    [<br />      </font><font color="#5a5a5a">; If there is tourist then:</font><font color="#000000"><br />      </font><font color="#5a5a5a">; Set a new list as a indicator for status, which is simply [s i r]</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> sir-indicator-list </font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">&quot;s&quot;</font><font color="#000000"> </font><font color="#963700">&quot;i&quot;</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> sir-indicator-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">&quot;r&quot;</font><font color="#000000"> sir-indicator-list<br />      </font><font color="#5a5a5a">; For each tourist, pick their status independently and store their status in a new list</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> tourist-status-list []<br />      </font><font color="#0000aa">repeat</font><font color="#000000"> pop-tourists[<br />        </font><font color="#0000aa">let</font><font color="#000000"> q </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> q-index </font><font color="#660096">position</font><font color="#000000"> q (</font><font color="#660096">sort</font><font color="#000000"> </font><font color="#660096">lput</font><font color="#000000"> q here-pop-normalised-list)<br />        </font><font color="#0000aa">set</font><font color="#000000"> tourist-status-list </font><font color="#660096">lput</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> q-index sir-indicator-list) tourist-status-list]<br />      </font><font color="#5a5a5a">; Count occurrence in the list and get the number of each status</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> t-pop-s </font><font color="#660096">reduce</font><font color="#000000"> [ [occurrence-count next-item] -&gt; </font><font color="#660096">ifelse-value</font><font color="#000000"> (next-item </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;s&quot;</font><font color="#000000">) [occurrence-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [occurrence-count] ] (</font><font color="#660096">fput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> tourist-status-list)<br />      </font><font color="#0000aa">set</font><font color="#000000"> t-pop-i </font><font color="#660096">reduce</font><font color="#000000"> [ [occurrence-count next-item] -&gt; </font><font color="#660096">ifelse-value</font><font color="#000000"> (next-item </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;i&quot;</font><font color="#000000">) [occurrence-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [occurrence-count] ] (</font><font color="#660096">fput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> tourist-status-list)<br />      </font><font color="#0000aa">set</font><font color="#000000"> t-pop-r </font><font color="#660096">reduce</font><font color="#000000"> [ [occurrence-count next-item] -&gt; </font><font color="#660096">ifelse-value</font><font color="#000000"> (next-item </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;r&quot;</font><font color="#000000">) [occurrence-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [occurrence-count] ] (</font><font color="#660096">fput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> tourist-status-list)<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;3.;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-turtles-population-Migration<br /><br />  </font><font color="#5a5a5a">;For origins: as tourists are leaving, population should go down</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#5a5a5a">; update each S/I/R group</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-s (pop-s </font><font color="#660096">-</font><font color="#000000"> t-pop-s)<br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-i (pop-i </font><font color="#660096">-</font><font color="#000000"> t-pop-i)<br />    </font><font color="#0000aa">set</font><font color="#000000"> pop-r (pop-r </font><font color="#660096">-</font><font color="#000000"> t-pop-r)<br />    </font><font color="#5a5a5a">; update the whole population</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> current-pop (pop-i </font><font color="#660096">+</font><font color="#000000"> pop-s </font><font color="#660096">+</font><font color="#000000"> pop-r)<br />  ]<br /><br />  </font><font color="#5a5a5a">; For destinations: as tourists are coming, population should go up</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#5a5a5a">; for each node, find their corresponding destination node and passing the values for them to update</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who[<br />      </font><font color="#5a5a5a">; update each S/I/R group</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> pop-s (pop-s </font><font color="#660096">+</font><font color="#000000"> [t-pop-s] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">)<br />      </font><font color="#0000aa">set</font><font color="#000000"> pop-i (pop-i </font><font color="#660096">+</font><font color="#000000"> [t-pop-i] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">)<br />      </font><font color="#0000aa">set</font><font color="#000000"> pop-r (pop-r </font><font color="#660096">+</font><font color="#000000"> [t-pop-r] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">)<br />      </font><font color="#5a5a5a">; update the overall population</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> current-pop (pop-i </font><font color="#660096">+</font><font color="#000000"> pop-s </font><font color="#660096">+</font><font color="#000000"> pop-r)<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;4.1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-links-color<br />  </font><font color="#5a5a5a">; At beginning, set all links the same color</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"><br />  [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> ]<br /><br />  </font><font color="#5a5a5a">; Then, update the links color</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br /><br /><br />    </font><font color="#5a5a5a">; 1: Take care of those who are both destination and origin (say 2 node, A and B)</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> [turtle-who] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who<br />    [<br />      </font><font color="#5a5a5a">; Scenario 1. if no tourist are generated, BOTH from A and B</font><font color="#000000"><br />      </font><font color="#5a5a5a">; set link to the origin color gray</font><font color="#000000"><br />      </font><font color="#0000aa">ifelse</font><font color="#000000"> pop-tourists </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [pop-tourists] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />      [ </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000">]]<br />      [<br />        </font><font color="#5a5a5a">; Scneario 2. if all tourists are susceptible, BOTH from A and B,</font><font color="#000000"><br />        </font><font color="#5a5a5a">; set the link blue</font><font color="#000000"><br />        </font><font color="#0000aa">ifelse</font><font color="#000000"> t-pop-s </font><font color="#660096">=</font><font color="#000000"> pop-tourists </font><font color="#660096">and</font><font color="#000000"> [t-pop-s] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who </font><font color="#660096">=</font><font color="#000000"> [pop-tourists] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who[<br />          </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who<br />          [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> ]]<br />        [<br />          </font><font color="#5a5a5a">; Scneario 3. if there is infected tourist, EITHER from A and B,</font><font color="#000000"><br />          </font><font color="#5a5a5a">; set the link red</font><font color="#000000"><br />          </font><font color="#0000aa">ifelse</font><font color="#000000"> t-pop-i </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> [t-pop-i] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">[<br />            </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who<br />            [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"> ]]<br />          [<br />            </font><font color="#5a5a5a">; Scenario 4. if no tourist are infected, Both from A and B</font><font color="#000000"><br />            </font><font color="#5a5a5a">; deduced by the situation, they are resistant, set link green</font><font color="#000000"><br />            </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who<br />            [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000">]<br />          ]<br />        ]<br />      ]<br />    ]<br />    </font><font color="#5a5a5a">; 2: No worry about both destination and origin</font><font color="#000000"><br />    [<br />      </font><font color="#5a5a5a">;Scenario 1. if no tourist, set link to the origin color gray</font><font color="#000000"><br />      </font><font color="#0000aa">ifelse</font><font color="#000000"> pop-tourists </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />      [ </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000">]]<br />      [<br />        </font><font color="#5a5a5a">; Scenario 2. if all tourists are susceptible, set the link blue</font><font color="#000000"><br />        </font><font color="#0000aa">ifelse</font><font color="#000000"> t-pop-s </font><font color="#660096">=</font><font color="#000000"> pop-tourists [<br />          </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who<br />          [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> ]]<br />        [<br />          </font><font color="#5a5a5a">; Scneario 3. if there is infected tourist, set the link red</font><font color="#000000"><br />          </font><font color="#0000aa">ifelse</font><font color="#000000"> t-pop-i </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />            </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who<br />            [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"> ]]<br />          [<br />            </font><font color="#5a5a5a">; Scenario 4. if no tourist are infected, deduced by the situation, they are resistant, set link green</font><font color="#000000"><br />            </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> turtle-who<br />            [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000">]<br />          ]<br />        ]<br />      ]<br />    ]<br />  ]<br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;4.2;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-turtles-color<br />  </font><font color="#5a5a5a">; when all population are set, it is going to update color for each node based on that</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  [<br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> pop-s </font><font color="#660096">=</font><font color="#000000"> current-pop<br />    </font><font color="#5a5a5a">; BLUE = all Susceptible</font><font color="#000000"><br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000">]<br />    [<br />      </font><font color="#0000aa">ifelse</font><font color="#000000"> pop-r </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">0.9</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> current-pop<br />      </font><font color="#5a5a5a">; RED = majority not Resistant and exist infection</font><font color="#000000"><br />      [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]<br />      </font><font color="#5a5a5a">; GREEN = majority Resistant</font><font color="#000000"><br />      [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000">]<br />    ]<br /><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;5.1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> monitor-pop-all-turtles<br /><br />  </font><font color="#5a5a5a">; set to be empty lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r []<br /><br />  </font><font color="#5a5a5a">; store population of each turtles</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop </font><font color="#660096">lput</font><font color="#000000"> (current-pop) total-pop<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s </font><font color="#660096">lput</font><font color="#000000"> (pop-s) total-pop-s<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i </font><font color="#660096">lput</font><font color="#000000"> (pop-i) total-pop-i<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r </font><font color="#660096">lput</font><font color="#000000"> (pop-r) total-pop-r<br />  ]<br /><br />  </font><font color="#5a5a5a">; get the sum of the lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> sum-total-pop </font><font color="#660096">sum</font><font color="#000000"> total-pop<br />  </font><font color="#0000aa">set</font><font color="#000000"> %-sum-total-pop-s (</font><font color="#660096">sum</font><font color="#000000"> total-pop-s) </font><font color="#660096">/</font><font color="#000000"> sum-total-pop<br />  </font><font color="#0000aa">set</font><font color="#000000"> %-sum-total-pop-i (</font><font color="#660096">sum</font><font color="#000000"> total-pop-i) </font><font color="#660096">/</font><font color="#000000"> sum-total-pop<br />  </font><font color="#0000aa">set</font><font color="#000000"> %-sum-total-pop-r (</font><font color="#660096">sum</font><font color="#000000"> total-pop-r) </font><font color="#660096">/</font><font color="#000000"> sum-total-pop<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;5.2;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> monitor-pop-urban-turtles<br /><br />  </font><font color="#5a5a5a">; set to be empty lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-urban []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s-urban []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i-urban []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r-urban []<br /><br />  </font><font color="#5a5a5a">; store population of each turtles</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">shape</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;house&quot;</font><font color="#000000">][<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-urban </font><font color="#660096">lput</font><font color="#000000"> (current-pop) total-pop-urban<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s-urban </font><font color="#660096">lput</font><font color="#000000"> (pop-s) total-pop-s-urban<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i-urban </font><font color="#660096">lput</font><font color="#000000"> (pop-i) total-pop-i-urban<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r-urban </font><font color="#660096">lput</font><font color="#000000"> (pop-r) total-pop-r-urban<br />  ]<br /><br />  </font><font color="#5a5a5a">; get the sum of the lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> sum-total-pop-urban </font><font color="#660096">sum</font><font color="#000000"> total-pop-urban<br />  </font><font color="#0000aa">set</font><font color="#000000"> %-sum-total-pop-s-urban (</font><font color="#660096">sum</font><font color="#000000"> total-pop-s-urban) </font><font color="#660096">/</font><font color="#000000"> sum-total-pop-urban<br />  </font><font color="#0000aa">set</font><font color="#000000"> %-sum-total-pop-i-urban (</font><font color="#660096">sum</font><font color="#000000"> total-pop-i-urban) </font><font color="#660096">/</font><font color="#000000"> sum-total-pop-urban<br />  </font><font color="#0000aa">set</font><font color="#000000"> %-sum-total-pop-r-urban (</font><font color="#660096">sum</font><font color="#000000"> total-pop-r-urban) </font><font color="#660096">/</font><font color="#000000"> sum-total-pop-urban<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;5.3;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> monitor-pop-rural-turtles<br /><br />  </font><font color="#5a5a5a">; set to be empty lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-rural []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s-rural []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i-rural []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r-rural []<br /><br />  </font><font color="#5a5a5a">; store population of each turtles</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">shape</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;triangle&quot;</font><font color="#000000">][<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-rural </font><font color="#660096">lput</font><font color="#000000"> (current-pop) total-pop-rural<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s-rural </font><font color="#660096">lput</font><font color="#000000"> (pop-s) total-pop-s-rural<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i-rural </font><font color="#660096">lput</font><font color="#000000"> (pop-i) total-pop-i-rural<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r-rural </font><font color="#660096">lput</font><font color="#000000"> (pop-r) total-pop-r-rural<br />  ]<br /><br />  </font><font color="#5a5a5a">; get the sum of the lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> sum-total-pop-rural </font><font color="#660096">sum</font><font color="#000000"> total-pop-rural<br />  </font><font color="#0000aa">set</font><font color="#000000"> %-sum-total-pop-s-rural (</font><font color="#660096">sum</font><font color="#000000"> total-pop-s-rural) </font><font color="#660096">/</font><font color="#000000"> sum-total-pop-rural<br />  </font><font color="#0000aa">set</font><font color="#000000"> %-sum-total-pop-i-rural (</font><font color="#660096">sum</font><font color="#000000"> total-pop-i-rural) </font><font color="#660096">/</font><font color="#000000"> sum-total-pop-rural<br />  </font><font color="#0000aa">set</font><font color="#000000"> %-sum-total-pop-r-rural (</font><font color="#660096">sum</font><font color="#000000"> total-pop-r-rural) </font><font color="#660096">/</font><font color="#000000"> sum-total-pop-rural<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;6.1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> monitor-pop-%-all-turtles<br />  </font><font color="#5a5a5a">; set to be empty lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s-% []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i-% []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r-% []<br /><br />  </font><font color="#5a5a5a">; store population of each turtles</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s-% </font><font color="#660096">lput</font><font color="#000000"> (pop-s </font><font color="#660096">/</font><font color="#000000"> current-pop) total-pop-s-%<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i-% </font><font color="#660096">lput</font><font color="#000000"> (pop-i </font><font color="#660096">/</font><font color="#000000"> current-pop) total-pop-i-%<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r-% </font><font color="#660096">lput</font><font color="#000000"> (pop-r </font><font color="#660096">/</font><font color="#000000"> current-pop) total-pop-r-%<br />  ]<br /><br />  </font><font color="#5a5a5a">; get the mean of the lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> mean-total-pop-s-% </font><font color="#660096">mean</font><font color="#000000"> total-pop-s-%<br />  </font><font color="#0000aa">set</font><font color="#000000"> mean-total-pop-i-% </font><font color="#660096">mean</font><font color="#000000"> total-pop-i-%<br />  </font><font color="#0000aa">set</font><font color="#000000"> mean-total-pop-r-% </font><font color="#660096">mean</font><font color="#000000"> total-pop-r-%<br /><br />  </font><font color="#5a5a5a">;get the variacne of the lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> var-total-pop-r-% </font><font color="#660096">variance</font><font color="#000000"> total-pop-r-%<br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;6.2;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> monitor-pop-%-urban-turtles<br /><br />  </font><font color="#5a5a5a">; set to be empty lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s-%-urban []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i-%-urban []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r-%-urban []<br /><br />  </font><font color="#5a5a5a">; store population rate of each turtles in cities</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">shape</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;house&quot;</font><font color="#000000">][<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s-%-urban </font><font color="#660096">lput</font><font color="#000000"> (pop-s </font><font color="#660096">/</font><font color="#000000"> current-pop) total-pop-s-%-urban<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i-%-urban </font><font color="#660096">lput</font><font color="#000000"> (pop-i </font><font color="#660096">/</font><font color="#000000"> current-pop) total-pop-i-%-urban<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r-%-urban </font><font color="#660096">lput</font><font color="#000000"> (pop-r </font><font color="#660096">/</font><font color="#000000"> current-pop) total-pop-r-%-urban<br />  ]<br /><br />  </font><font color="#5a5a5a">; get the mean of the lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> mean-total-pop-s-%-urban </font><font color="#660096">mean</font><font color="#000000"> total-pop-s-%-urban<br />  </font><font color="#0000aa">set</font><font color="#000000"> mean-total-pop-i-%-urban </font><font color="#660096">mean</font><font color="#000000"> total-pop-i-%-urban<br />  </font><font color="#0000aa">set</font><font color="#000000"> mean-total-pop-r-%-urban </font><font color="#660096">mean</font><font color="#000000"> total-pop-r-%-urban<br /><br />  </font><font color="#5a5a5a">;get the variacne of the lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> var-total-pop-r-%-urban </font><font color="#660096">variance</font><font color="#000000"> total-pop-r-%-urban<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;6.3;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> monitor-pop-%-rural-turtles<br /><br />  </font><font color="#5a5a5a">; set to be empty lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s-%-rural []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i-%-rural []<br />  </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r-%-rural []<br /><br />  </font><font color="#5a5a5a">; store population rate of each turtles in countryside</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">shape</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;triangle&quot;</font><font color="#000000">][<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-s-%-rural </font><font color="#660096">lput</font><font color="#000000"> (pop-s </font><font color="#660096">/</font><font color="#000000"> current-pop) total-pop-s-%-rural<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-i-%-rural </font><font color="#660096">lput</font><font color="#000000"> (pop-i </font><font color="#660096">/</font><font color="#000000"> current-pop) total-pop-i-%-rural<br />    </font><font color="#0000aa">set</font><font color="#000000"> total-pop-r-%-rural </font><font color="#660096">lput</font><font color="#000000"> (pop-r </font><font color="#660096">/</font><font color="#000000"> current-pop) total-pop-r-%-rural<br />  ]<br /><br />  </font><font color="#5a5a5a">; get the mean of the lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> mean-total-pop-s-%-rural </font><font color="#660096">mean</font><font color="#000000"> total-pop-s-%-rural<br />  </font><font color="#0000aa">set</font><font color="#000000"> mean-total-pop-i-%-rural </font><font color="#660096">mean</font><font color="#000000"> total-pop-i-%-rural<br />  </font><font color="#0000aa">set</font><font color="#000000"> mean-total-pop-r-%-rural </font><font color="#660096">mean</font><font color="#000000"> total-pop-r-%-rural<br /><br />  </font><font color="#5a5a5a">;get the variacne of the lists</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> var-total-pop-r-%-rural </font><font color="#660096">variance</font><font color="#000000"> total-pop-r-%-rural<br /></font><font color="#007f69">end</font>
</pre>
